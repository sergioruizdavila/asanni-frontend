{"version":3,"sources":["app/pages/countryProfilePage/countryProfilePage.controller.ts"],"names":[],"mappings":"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","file":"../../../../www/app/pages/countryProfilePage/countryProfilePage.controller.js","sourcesContent":["/**\n * CountryProfilePageController\n * @description - Landing Page Controller\n */\n\nmodule app.pages.countryProfilePage {\n\n    /**********************************/\n    /*           INTERFACES           */\n    /**********************************/\n    export interface ICountryProfilePageController {\n        activate: () => void;\n    }\n\n    export interface ILandingScope extends angular.IScope {\n\n    }\n\n    /********************************/\n    /*    STATEPARAMS INTERFACES    */\n    /********************************/\n    export interface ICountryParams extends ng.ui.IStateParamsService {\n        id: string;\n        aliasCountry: string;\n    }\n\n    interface ICountryQueryObject {\n        next: string;\n        previous: string;\n        count: number;\n        results: Array<app.models.country.Country>;\n    }\n\n    interface ICountrySchoolsQueryObject {\n        next: string;\n        previous: string;\n        count: number;\n        results: Array<app.models.school.School>;\n    }\n\n    interface ICountryTeachersQueryObject {\n        next: string;\n        previous: string;\n        count: number;\n        results: Array<app.models.teacher.Teacher>;\n    }\n\n    export interface ILandingError {\n        message: string;\n    }\n\n    /****************************************/\n    /*           CLASS DEFINITION           */\n    /****************************************/\n    export class CountryProfilePageController implements ICountryProfilePageController {\n\n        static controllerId = 'mainApp.pages.countryProfilePage.CountryProfilePageController';\n\n        /**********************************/\n        /*           PROPERTIES           */\n        /**********************************/\n        isAuthenticated: boolean;\n        isTeacher: boolean;\n        data: app.models.country.Country;\n        private _slideout: boolean;\n        countryObject: app.core.interfaces.IDataFromJsonI18n;\n        listCountries: Array<app.core.interfaces.IDataFromJsonI18n>;\n        _schoolsList: Array<app.models.school.School>;\n        _teachersList: Array<app.models.teacher.Teacher>;\n        private _countryContainers: Array<app.models.country.Country>;\n        private _currencyConverted: string;\n        loading: boolean;\n        // --------------------------------\n\n\n        /*-- INJECT DEPENDENCIES --*/\n        public static $inject = ['$scope',\n                                 '$state',\n                                 '$stateParams',\n                                 'dataConfig',\n                                 'mainApp.auth.AuthService',\n                                 'mainApp.models.country.CountryService',\n                                 'mainApp.models.school.SchoolService',\n                                 'mainApp.models.teacher.TeacherService',\n                                 'mainApp.core.util.FunctionsUtilService',\n                                 '$rootScope'];\n\n        /**********************************/\n        /*           CONSTRUCTOR          */\n        /**********************************/\n        constructor(\n            private $scope: angular.IScope,\n            private $state: ng.ui.IStateService,\n            private $stateParams: ICountryParams,\n            private dataConfig: IDataConfig,\n            private AuthService: app.auth.IAuthService,\n            private CountryService: app.models.country.ICountryService,\n            private SchoolService: app.models.school.ISchoolService,\n            private TeacherService: app.models.teacher.ITeacherService,\n            private FunctionsUtil: app.core.util.functionsUtil.IFunctionsUtilService,\n            private $rootScope: app.core.interfaces.IMainAppRootScope) {\n\n            this._init();\n\n        }\n\n        /*-- INITIALIZE METHOD --*/\n        private _init() {\n\n            //Init profile school data\n            this.data = new app.models.country.Country();\n\n            //Init loading\n            this.loading = true;\n\n            this.activate();\n        }\n\n        /*-- ACTIVATE METHOD --*/\n        activate(): void {\n            //CONSTANTS\n            const ENTER_MIXPANEL = 'Enter: Country Profile Page: ' + this.$stateParams.aliasCountry;\n            //VARIABLES\n            let self = this;\n            //LOG\n            DEBUG && console.log('countryProfilePage controller actived');\n\n            //MIXPANEL\n            mixpanel.track(ENTER_MIXPANEL);\n\n            // Get Country information\n            this.CountryService.getCountryByAlias(this.$stateParams.aliasCountry).then(\n                function(response) {\n                    self.data = new app.models.country.Country(response);\n                    //Build meta tags\n                    //self._buildMetaTags(self.data);\n\n                    // Get currency converted\n                    self._getCurrencyConverted(self.data.CurrencyCode);\n\n                    //Build Schools cards associated to this country\n                    self._buildSchoolCards(self.data);\n\n                    //Build Teachers cards associated to this country\n                    self._buildTeacherCards(self.data);\n\n                    self.loading = false;\n                }\n            );\n\n        }\n\n        /**********************************/\n        /*            METHODS             */\n        /**********************************/\n\n        _buildTeacherCards(country: app.models.country.Country): void {\n            //VARIABLES\n            let self = this;\n\n            this.TeacherService.getAllTeachersByCountry(country.Id).then(\n                function(response: ICountryTeachersQueryObject) {\n                    self._teachersList = response.results;\n                },\n                function(error) {\n                    //CONSTANTS\n                    const ERROR_MESSAGE = 'Error countryProfilePage.controller.js method: _buildTeacherCards ';\n                    Raven.captureMessage(ERROR_MESSAGE, error);\n                }\n            );\n        }\n\n\n        _buildSchoolCards(country: app.models.country.Country): void {\n            //VARIABLES\n            let self = this;\n\n            this.SchoolService.getAllSchoolsByCountry(country.Id).then(\n                function(response: ICountrySchoolsQueryObject) {\n                    self._schoolsList = response.results;\n                },\n                function(error) {\n                    //CONSTANTS\n                    const ERROR_MESSAGE = 'Error countryProfilePage.controller.js method: _buildSchoolCards ';\n                    Raven.captureMessage(ERROR_MESSAGE, error);\n                }\n            );\n        }\n\n\n\n        _getCurrencyConverted(code: string) {\n            //VARIABLES\n            let self = this;\n\n            this.FunctionsUtil.getCurrencyConverted(code).then(\n                function(response: string) {\n                    self._currencyConverted = response;\n                },\n                function(error) {\n                    //CONSTANTS\n                    const ERROR_MESSAGE = 'Error countryProfilePage.controller.js method: _getCurrencyConverted ';\n                    Raven.captureMessage(ERROR_MESSAGE, error);\n                    self._currencyConverted = '-';\n                }\n            );\n        }\n\n\n    }\n\n    /*-- MODULE DEFINITION --*/\n    angular\n        .module('mainApp.pages.countryProfilePage')\n        .controller(CountryProfilePageController.controllerId, CountryProfilePageController);\n\n}\n"]}